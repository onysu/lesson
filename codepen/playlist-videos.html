<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Playlist Videos</title>
  <style>
    #video-wrapper {
      position: relative;
      width: 100%;
      height: 0;
      padding-bottom: 56.25%;
      background-color: #A1A1A1;
    }

    #video-player {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      background-color: #010101;
    }

    #video-order {
      position: relative;
      opacity: 0;
      pointer-events: none;
      -webkit-transition: opacity 1000ms ease;
      transition: opacity 1000ms ease;
    }

    #video-order.show {
      opacity: 1;
    }

    #video-controls ul {
      margin: 0;
      padding: 0;
      list-style: none;
    }

    #video-controls ul li {
      display: inline-block;
    }
  </style>
</head>

<body>
  <div id="video-wrapper">
    <video controls id="video-player"></video>
  </div>
  <div id="video-order"></div>
  <div id="video-controls">
    <ul>
      <li><a href="#" id="toggle-video">Play</a></li>
      <li><a href="#" id="play-previous-video">Previous</a></li>
      <li><a href="#" id="play-next-video">Next</a></li>
    </ul>
  </div>
  <div id="video-playlist"></div>

  <script>
    var videos = [
      [1, 'Video 1', 'https://mainline.i3s.unice.fr/mooc/week2p1/video2.mp4'],
      [2, 'Video 2', 'https://mainline.i3s.unice.fr/mooc/week2p1/video1.mp4'],
      [3, 'Video 3', 'https://mainline.i3s.unice.fr/mooc/week2p1/video3.mp4'],
      [4, 'Video 4', 'https://mainline.i3s.unice.fr/mooc/week2p1/video4.mp4']
    ];
    var videos_count = videos.length - 1;
    var video_current = 0;
    var $video_wrapper = document.getElementById('video-wrapper');
    var $video_player = document.getElementById('video-player');
    var $video_playlist = document.getElementById('video-playlist');
    var $video_order = document.getElementById('video-order');
    var $toggle_video = document.getElementById('toggle-video');
    var $play_next_video = document.getElementById('play-next-video');
    var $play_previous_video = document.getElementById('play-previous-video');

    $video_player.addEventListener('playing', videoPlaying);
    $video_player.addEventListener('pause', videoPause);
    $toggle_video.addEventListener("click", function (e) {
      e.preventDefault();
      if ($video_player.paused) {
        $video_player.play();
      } else {
        $video_player.pause();
      }
    });
    $play_next_video.addEventListener("click", function (e) {
      e.preventDefault();
      nextVideoCurrent();
      videoLoad();
      videoPlay();
    });
    $play_previous_video.addEventListener("click", function (e) {
      e.preventDefault();
      previousVideoCurrent();
      videoLoad();
      videoPlay();
    });

    function videoPlaying() {
      $toggle_video.innerHTML = 'Pause';
    }

    function videoPause() {
      $toggle_video.innerHTML = 'Play';
    }

    function showCurrentVideoOrder() {
      $video_order.innerHTML = videos[video_current][0] + ' - ' + videos[video_current][1];
      $video_order.classList.add("show");
    }

    function videoLoad() {
      $video_player.setAttribute("src", videos[video_current][2]);
      $video_player.load();
      showCurrentVideoOrder();
    }

    function videoPlay() {
      $video_player.play();
    }

    function nextVideoCurrent() {
      if (video_current < videos_count) {
        video_current++;
      } else {
        video_current = 0;
      }
    }

    function previousVideoCurrent() {
      if (video_current == 0) {
        video_current = videos_count;
      } else {
        video_current--;
      }
    }

    function onVideoEnded() {
      if (video_current < videos_count) {
        $video_order.classList.remove("show");
        nextVideoCurrent();
        videoLoad();
        videoPlay();
      } else {
        resetVideoplayer();
      }
    }

    function resetVideoplayer() {
      video_current = 0;
      videoLoad();
    }

    function videoCreatePlaylist() {
      for (i = 0; i < videos.length; i++) {
        var node = document.createElement('div');
        var anchor = document.createElement('a');
        anchor.href = '#';
        var class_attr = document.createAttribute('class');
        class_attr.value = 'playlist-item';
        anchor.setAttributeNode(class_attr);
        var
          data_attr = document.createAttribute('data-index');
        data_attr.value = i;
        anchor.setAttributeNode(data_attr);
        var
          order = videos[i][0];
        var title = videos[i][1];
        var textnode = document.createTextNode(order + ' - ' + title);
        anchor.appendChild(textnode);
        node.appendChild(anchor);
        $video_playlist.appendChild(node);
      }
    }
    $video_playlist.addEventListener('click', function (event) {
      event.preventDefault();
      if (event.target.classList.contains('playlist-item')) {
        var data_index = event.target.dataset.index;
        video_current = data_index;
        videoLoad();
        videoPlay();
      }
    })

    function initVideoPlayer() {
      $video_player.addEventListener('ended', onVideoEnded);
      videoLoad();
      videoCreatePlaylist();
    }
    window.addEventListener("load", initVideoPlayer);
  </script>
</body>

</html>